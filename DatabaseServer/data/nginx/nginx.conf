# generated 2021-12-30, Mozilla Guideline v5.6, nginx 1.17.7, OpenSSL 1.1.1d, modern configuration
# https://ssl-config.mozilla.org/#server=nginx&version=1.17.7&config=modern&openssl=1.1.1d&guideline=5.6

#user       www www;  ## Default: nobody
worker_processes  5;  ## Default: 1
error_log  /var/log/nginx/error.log;

pid        /var/log/nginx/nginx.pid;
worker_rlimit_nofile 8192;

events {
  worker_connections  4096;  ## Default: 1024
}


stream {
  upstream postgres {
    server postgres:5432;
  }

  server {
    listen                12345 ssl;
    proxy_pass            postgres;

    #log_format basic '$remote_addr [$time_local] '
    #                 '$protocol $status $bytes_sent $bytes_received '
    #                 '$session_time';


    #access_log   /var/log/nginx/access.log basic;

    ssl_certificate /etc/letsencrypt/live/database.thomsen-it.dk/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/database.thomsen-it.dk/privkey.pem;
    ssl_session_timeout 1d;
    ssl_session_cache shared:MozSSL:10m;  # about 40000 sessions
    ssl_session_tickets off;
  }
}

